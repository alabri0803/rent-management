# ๐ ุฏููู ูุธุงู ุฅุดุนุงุฑุงุช ูุฅูุฐุงุฑุงุช ุงูุนููุฏ

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุชููุงุฆู ุดุงูู ูุฅุฏุงุฑุฉ ุฅุดุนุงุฑุงุช ูุฅูุฐุงุฑุงุช ุนููุฏ ุงูุฅูุฌุงุฑุ ูุชุนุงูู ูุน:
- โ ุฑุณุงุฆู ุชุฐููุฑ ุงูุชุฌุฏูุฏ
- โ๏ธ ุฅูุฐุงุฑุงุช ุชุฃุฎูุฑ ุงูุชุฌุฏูุฏ
- ๐ ุฅูุดุงุก ูุณุชูุฏุงุช PDF ุชููุงุฆูุฉ
- ๐ ุฅุดุนุงุฑุงุช ูููุณุชุฃุฌุฑูู ูุงูููุธููู

---

## ๐ ุขููุฉ ุงูุนูู

### 1๏ธโฃ **ุงูุนููุฏ ุงููุฑูุจุฉ ูู ุงูุงูุชูุงุก (Expiring Soon)**
**ุงููุฏุฉ:** ุดูุฑ ูุงุญุฏ ูุจู ุงูุงูุชูุงุก

**ุงูุฅุฌุฑุงุกุงุช ุงูุชููุงุฆูุฉ:**
- ๐ง ุฅุดุนุงุฑ: "ุนูุฏ ุงูุฅูุฌุงุฑ ุงูุฎุงุต ุจู ุฑูู {X} ุณููุชูู ูุฑูุจ"
- ๐ฌ ุฑุณุงูุฉ: "ูู ูุฏูู ุฑุบุจุฉ ูู ุชุฌุฏูุฏ ุนูุฏ ุงูุฅูุฌุงุฑ ุฑูู {X}ุ"

**ูุชู ุชูุฑุณู:**
- ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุงูุนูุฏ ุฅูู `expiring_soon` (ุชููุงุฆูุงู)
- ุนูุฏ ุชุดุบูู ุฃูุฑ `update_lease_statues`

---

### 2๏ธโฃ **ุงูุนููุฏ ุงูููุชููุฉ ุญุฏูุซุงู (0-3 ุฃุดูุฑ)**
**ุงููุฏุฉ:** ูู ุชุงุฑูุฎ ุงูุงูุชูุงุก ุญุชู 3 ุฃุดูุฑ

**ุงูุฅุฌุฑุงุกุงุช ุงูุชููุงุฆูุฉ:**
- ๐ฌ ุฑุณุงูุฉ: "ุนูุฏ ุงูุฅูุฌุงุฑ ุฑูู {X} ุงูุชูู ูู {ุชุงุฑูุฎ}. ูู ุชุฑุบุจ ูู ุชุฌุฏูุฏูุ"

**ูุชู ุชูุฑุณู:**
- ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุงูุนูุฏ ุฅูู `expired` (ุชููุงุฆูุงู)
- ุนูุฏ ุชุดุบูู ุฃูุฑ `check_expired_leases`

---

### 3๏ธโฃ **ุงูุนููุฏ ุงูููุชููุฉ ุจุชุฃุฎูุฑ (3+ ุฃุดูุฑ)**
**ุงููุฏุฉ:** ุจุนุฏ 3 ุฃุดูุฑ ูู ุงูุงูุชูุงุก

**ุงูุฅุฌุฑุงุกุงุช ุงูุชููุงุฆูุฉ:**
- โ๏ธ ุฅูุฐุงุฑ ูููุณุชุฃุฌุฑ: "ุฅูุฐุงุฑ: ุชุฃุฎูุฑ ูู ุชุฌุฏูุฏ ุนูุฏ ุงูุฅูุฌุงุฑ ุฑูู {X}"
- ๐ข ุชูุจูู ููููุธููู: "ุชูุจูู: ุนูุฏ {X} ูุชุฃุฎุฑ ูู ุงูุชุฌุฏูุฏ"
- ๐ **PDF ุฑุณูู**: "ุฅูุฐุงุฑ ุชุฃุฎูุฑ ุชุฌุฏูุฏ ุนูุฏ - {X}"

**ูุชู ุชูุฑุณู:**
- ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุงูุนูุฏ ุฅูู `expired` (ุชููุงุฆูุงู)
- ุนูุฏ ุชุดุบูู ุฃูุฑ `check_expired_leases`

---

## ๐๏ธ ุฃูุงูุฑ ุงูุชุดุบูู

### โก ุงูุฃูุฑ ุงูุดุงูู (ููุตู ุจู)
```bash
# ุงุฎุชุจุงุฑ ุจุฏูู ุชุทุจูู ูุนูู
python manage.py process_lease_notifications --dry-run

# ุชูููุฐ ูุนูู
python manage.py process_lease_notifications
```

**ูุง ููุนูู:**
1. ุชุญุฏูุซ ุญุงูุงุช ุฌููุน ุงูุนููุฏ
2. ูุญุต ุงูุนููุฏ ุงูููุชููุฉ ูุฅูุดุงุก ุงูุฅุดุนุงุฑุงุช
3. ุฅูุดุงุก ุชุฐููุฑุงุช ุงูุชุฌุฏูุฏ ููุนููุฏ ุงููุฑูุจุฉ

---

### ๐ ูุญุต ุงูุนููุฏ ุงูููุชููุฉ ููุท
```bash
# ุงุฎุชุจุงุฑ
python manage.py check_expired_leases --dry-run

# ุชูููุฐ
python manage.py check_expired_leases
```

**ูุง ููุนูู:**
- ููุญุต ุฌููุน ุงูุนููุฏ ุงูููุชููุฉ
- ูููุดุฆ ุงูุฅุดุนุงุฑุงุช ุงูููุงุณุจุฉ ุญุณุจ ูุฏุฉ ุงูุงูุชูุงุก
- ูููุดุฆ ูููุงุช PDF ููุฅูุฐุงุฑุงุช (ุจุนุฏ 3 ุฃุดูุฑ)

---

### ๐ ุชุญุฏูุซ ุญุงูุงุช ุงูุนููุฏ
```bash
python manage.py update_lease_statues
```

**ูุง ููุนูู:**
- ูุญุฏุซ ุญุงูุฉ ูู ุนูุฏ ุญุณุจ ุชุงุฑูุฎ ุงูุงูุชูุงุก:
  - `active` โ ูุดุท
  - `expiring_soon` โ ูุฑุจ ุงูุงูุชูุงุก (ุขุฎุฑ ุดูุฑ)
  - `expired` โ ููุชูู

---

### ๐ ุฅูุดุงุก ุชุฐููุฑุงุช ุงูุชุฌุฏูุฏ
```bash
# ุงุฎุชุจุงุฑ
python manage.py generate_renewal_reminders --dry-run

# ุชูููุฐ
python manage.py generate_renewal_reminders
```

**ูุง ููุนูู:**
- ูููุดุฆ ุชุฐููุฑุงุช ููุนููุฏ ุงูุชู ุณุชูุชูู ุฎูุงู 30 ููู
- ูุญูุธูุง ูู ุฌุฏูู `LeaseRenewalReminder`

---

## โฐ ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ

### ุงุณุชุฎุฏุงู Cron (Linux/Mac)
```bash
# ุงูุชุญ ููู crontab
crontab -e

# ุฃุถู ูุฐุง ุงูุณุทุฑ ููุชุดุบูู ููููุงู ุงูุณุงุนุฉ 9 ุตุจุงุญุงู
0 9 * * * cd /path/to/rent-management && /path/to/python manage.py process_lease_notifications >> /var/log/lease_notifications.log 2>&1
```

### ูุซุงู ุขุฎุฑ: ุงูุชุดุบูู ูู 6 ุณุงุนุงุช
```bash
0 */6 * * * cd /path/to/rent-management && /path/to/python manage.py process_lease_notifications
```

---

## ๐ ูุซุงู ุนูู ุงูุฅุฎุฑุงุฌ

```
================================================================================
๐ ูุธุงู ูุนุงูุฌุฉ ุฅุดุนุงุฑุงุช ูุฅูุฐุงุฑุงุช ุงูุนููุฏ ุงูุดุงูู
================================================================================

๐ ุงูุฎุทูุฉ 1: ุชุญุฏูุซ ุญุงูุงุช ุงูุนููุฏ...
--------------------------------------------------------------------------------
  - Lease 21053/2024 status updated to ููุชูู
โ ุชู ุชุญุฏูุซ ุญุงูุงุช ุงูุนููุฏ ุจูุฌุงุญ

๐ ุงูุฎุทูุฉ 2: ูุญุต ุงูุนููุฏ ุงูููุชููุฉ ูุฅูุดุงุก ุงูุฅุดุนุงุฑุงุช...
--------------------------------------------------------------------------------
๐ ูุญุต ุงูุนููุฏ ุงูููุชููุฉ ุจุชุงุฑูุฎ 2025-10-22

๐ ุฅุฌูุงูู ุงูุนููุฏ ุงูููุชููุฉ: 1

๐ ุงูุนูุฏ: 21053/2024 | ุงูุชูู ููุฐ: 6 ุดูุฑ ู 25 ููู
   โ ุชู ุฅุฑุณุงู: ุฅูุฐุงุฑ ุชุฃุฎูุฑ ูููุณุชุฃุฌุฑ
   โ ุชู ุฅูุดุงุก: PDF ุฅูุฐุงุฑ ุชุฃุฎูุฑ ุงูุชุฌุฏูุฏ

๐ ููุฎุต ุงูุนูููุฉ:
  โข ุฅุฌูุงูู ุงูุนููุฏ ุงูููุชููุฉ: 1
  โข ุฑุณุงุฆู ุงูุชุฌุฏูุฏ ุงูุฌุฏูุฏุฉ: 0
  โข ุฅูุฐุงุฑุงุช ุงูุชุฃุฎูุฑ ุงูุฌุฏูุฏุฉ: 1
  โข ูููุงุช PDF ุงููููุดุฃุฉ: 1

โ ุงูุชููุช ุฌููุน ุงูุนูููุงุช ุจูุฌุงุญ!
```

---

## ๐ ุงูุฅุดุนุงุฑุงุช ุงููููุดุฃุฉ

### ูููุณุชุฃุฌุฑูู:
| ุงูุญุงูุฉ | ุงูููุน | ุงูุฑุณุงูุฉ |
|--------|------|---------|
| **Expiring Soon** | ๐ง ุฅุดุนุงุฑ | "ุนูุฏ ุงูุฅูุฌุงุฑ ุงูุฎุงุต ุจู ุฑูู {X} ุณููุชูู ูุฑูุจ ูู ุชุงุฑูุฎ {ุชุงุฑูุฎ}" |
| **Expiring Soon** | ๐ฌ ุฑุณุงูุฉ ุชุฌุฏูุฏ | "ูู ูุฏูู ุฑุบุจุฉ ูู ุชุฌุฏูุฏ ุนูุฏ ุงูุฅูุฌุงุฑ ุฑูู {X}ุ ููุชูู ูู {ุชุงุฑูุฎ}" |
| **Expired (0-3 months)** | ๐ฌ ุฑุณุงูุฉ ุชุฌุฏูุฏ | "ุนูุฏ ุงูุฅูุฌุงุฑ ุฑูู {X} ุงูุชูู ูู {ุชุงุฑูุฎ}. ูู ุชุฑุบุจ ูู ุชุฌุฏูุฏูุ" |
| **Expired (3+ months)** | โ๏ธ ุฅูุฐุงุฑ | "ุฅูุฐุงุฑ: ุชุฃุฎูุฑ ูู ุชุฌุฏูุฏ ุนูุฏ ุงูุฅูุฌุงุฑ ุฑูู {X} ูุฃูุซุฑ ูู {ุนุฏุฏ} ุดูุฑ" |

### ููููุธููู:
| ุงูุญุงูุฉ | ุงูููุน | ุงูุฑุณุงูุฉ |
|--------|------|---------|
| **Expired (3+ months)** | ๐ข ุชูุจูู | "ุชูุจูู: ุนูุฏ {X} ูุชุฃุฎุฑ ูู ุงูุชุฌุฏูุฏ ููุฏุฉ {ุนุฏุฏ} ุดูุฑ" |

---

## ๐ ุงููุณุชูุฏุงุช ุงููููุดุฃุฉ

### ูููุงุช PDF ุงูุชููุงุฆูุฉ:
- **ุฅูุฐุงุฑ ุชุฃุฎูุฑ ุชุฌุฏูุฏ ุนูุฏ** - ูููุดุฃ ุชููุงุฆูุงู ุจุนุฏ 3 ุฃุดูุฑ ูู ุงูุงูุชูุงุก
- **ูููุน ุงูุญูุธ:** `media/documents/` (ูุฑุชุจุท ุจุงูุนูุฏ)
- **ุงุณู ุงูููู:** `overdue_renewal_{contract_number}.pdf`

---

## ๐ง ุงูุชุฎุตูุต

### ุชุบููุฑ ูุฏุฉ ุงูุฅูุฐุงุฑ (ูู 3 ุฃุดูุฑ ุฅูู ูุฏุฉ ุฃุฎุฑู):

#### ูู `signals.py` (ุงูุณุทุฑ 73):
```python
elif months_overdue >= 3:  # ุบููุฑ ุงูุฑูู 3 ุญุณุจ ุงูุญุงุฌุฉ
```

#### ูู `check_expired_leases.py` (ุงูุณุทุฑ 51):
```python
elif months_overdue >= 3:  # ุบููุฑ ุงูุฑูู 3 ุญุณุจ ุงูุญุงุฌุฉ
```

---

## โ ุงูููุฒุงุช

- โจ **ุชููุงุฆู ุจุงููุงูู** - ูุนูู ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุงูุนูุฏ
- ๐ **ููุน ุงูุชูุฑุงุฑ** - ูุง ูููุดุฆ ุฅุดุนุงุฑุงุช ููุฑุฑุฉ
- ๐ **ุชูุงุฑูุฑ ููุตูุฉ** - ุฅุญุตุงุฆูุงุช ุดุงููุฉ ููู ุนูููุฉ
- ๐งช **ูุถุน ุงูุงุฎุชุจุงุฑ** - `--dry-run` ูููุนุงููุฉ ูุจู ุงูุชูููุฐ
- ๐ **PDF ุงุญุชุฑุงูู** - ุฅูุฐุงุฑุงุช ุฑุณููุฉ ุจุชุตููู ุงุญุชุฑุงูู
- ๐ **ูุชุนุฏุฏ ุงููุบุงุช** - ุฏุนู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
- ๐ **ุขูู** - ูุง ููุนุฏูู ุนูู ุงูุจูุงูุงุชุ ููุท ูููุดุฆ ุฅุดุนุงุฑุงุช

---

## ๐ ุญู ุงููุดุงูู

### ุงููุดููุฉ: ูุง ุชุธูุฑ ุฅุดุนุงุฑุงุช ููุนููุฏ ุงูููุชููุฉ
**ุงูุญู:**
```bash
# 1. ุชุญุฏูุซ ุญุงูุงุช ุงูุนููุฏ
python manage.py update_lease_statues

# 2. ูุญุต ุงูุนููุฏ ุงูููุชููุฉ
python manage.py check_expired_leases

# ุฃู ุงุณุชุฎุฏู ุงูุฃูุฑ ุงูุดุงูู
python manage.py process_lease_notifications
```

### ุงููุดููุฉ: ุงููุณุชุฃุฌุฑ ูุง ูุณุชูู ุงูุฅุดุนุงุฑุงุช
**ุงูุญู:**
- ุชุฃูุฏ ูู ูุฌูุฏ ุญุณุงุจ ูุณุชุฎุฏู (`user`) ูุฑุชุจุท ุจุงููุณุชุฃุฌุฑ
- ุชุญูู ูู ุฌุฏูู `Notification` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงููุดููุฉ: ูุดู ุฅูุดุงุก PDF
**ุงูุณุจุจ:** ููุชุจุฉ `weasyprint` ุบูุฑ ูุซุจุชุฉ ุฃู ุจูุง ูุดููุฉ
**ุงูุญู:**
```bash
pip install weasyprint
# ุฃู ุงุณุชุฎุฏู ุงูุจุฏูู
pip install xhtml2pdf
```

---

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูุงุณุชูุณุงุฑุงุชุ ุฑุงุฌุน:
- ๐ ููู `signals.py` - ููู signals ุงูุชููุงุฆูุฉ
- ๐๏ธ ูุฌูุฏ `management/commands/` - ูุฃูุงูุฑ ุงูุชุดุบูู
- ๐ ููู `models.py` - ูููุงุฐุฌ ุงูุจูุงูุงุช

---

**ุชู ุฅูุดุงุคู:** 22 ุฃูุชูุจุฑ 2025
**ุงูุฅุตุฏุงุฑ:** 1.0
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ
