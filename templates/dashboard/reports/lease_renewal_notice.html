{% load i18n %}
{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>{% trans "استمارة تجديد عقد الإيجار" %}</title>
  <style>
    @font-face {
      font-family: 'Amiri';
      src: url("{% static 'fonts/Amiri-Regular.ttf' %}") format('truetype');
      font-weight: normal; font-style: normal;
    }
    html, body { height: 100%; }
    body { font-family: 'Amiri', Arial, sans-serif; direction: rtl; text-align: right; margin: 0; }
    .page { width: 210mm; min-height: 297mm; margin: 0 auto; padding: 10mm; box-sizing: border-box; border: 2px solid #000; position: relative; }
    .top-grid { display: grid; grid-template-columns: 1fr 1.2fr 1fr; gap: 8px; align-items: center; margin-bottom: 8px; }
    .top-box { border: 2px solid #000; padding: 8px; min-height: 54px; }
    .title-en { font-size: 18px; font-weight: 700; text-align: center; }
    .title-ar { font-size: 16px; font-weight: 700; text-align: center; }
    .logo-wrap { display: flex; justify-content: center; align-items: center; gap: 8px; }
    .circle { width: 54px; height: 54px; border: 2px solid #000; border-radius: 50%; }
    .qr { width: 70px; height: 70px; border: 2px solid #000; margin: 0 auto; }
    .pair { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; font-size: 12px; }
    .pair div { border: 1px dashed #aaa; padding: 6px; min-height: 26px; }
    .muted { color: #666; font-size: 11px; }
    .section { border: 2px solid #000; margin-top: 8px; }
    .section-title { background: #eaeaea; border-bottom: 2px solid #000; padding: 4px 8px; font-weight: 700; display: flex; justify-content: space-between; }
    .fields { padding: 6px; display: grid; grid-template-columns: repeat(12, 1fr); gap: 6px; }
    .field { border: 1px solid #000; padding: 6px; font-size: 12px; grid-column: span 3; min-height: 30px; }
    .field .lbl { color: #444; font-size: 11px; display: block; }
    .field .val { font-weight: 700; }
    .table { width: 100%; border-collapse: collapse; }
    .table th, .table td { border: 1px solid #000; padding: 6px; font-size: 12px; }
    .dash { border: 2px dashed #333; min-height: 60px; padding: 6px; }
    .sig-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 8px; }
    .tiny { font-size: 10px; color: #333; }
    .footer { position: absolute; bottom: 6mm; left: 10mm; right: 10mm; display: flex; justify-content: space-between; font-size: 12px; }
    .badge { background: #ffeaa7; border: 1px solid #d4b36c; padding: 4px 8px; }
  </style>
</head>
<body>
  <div class="page">
    <div class="top-grid">
      <div>
        <div class="top-box">
          <div class="muted">{% trans "Agreement No." %}</div>
          <div class="dash">{{ old_lease.contract_number|default:"" }}</div>
        </div>
        <div class="top-box" style="margin-top:8px;">
          <div class="muted">{% trans "Form No." %}</div>
          <div class="dash">{{ lease.contract_number|default:"" }}</div>
        </div>
      </div>
      <div>
        <div class="logo-wrap" style="margin-bottom:6px;">
          <div class="circle"></div>
          <div class="circle"></div>
          <div class="circle"></div>
        </div>
        <div class="title-en">Rent Contract Form</div>
        <div class="title-ar">استمارة عقد إيجار</div>
      </div>
      <div>
        <div class="qr"></div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">
        <span>{% trans "بيانات مالك العقار" %}</span>
      </div>
      <div class="fields">
        <div class="field"><span class="lbl">{% trans "اسم المالك" %}</span><span class="val">{{ lease.unit.building.owner.name|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "صلة المالك" %}</span><span class="val">{{ lease.unit.building.owner.owner_type|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "رقم المالك" %}</span><span class="val">{{ lease.unit.building.owner.phone|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "جوال" %}</span><span class="val">{{ lease.unit.building.owner.phone|default:"" }}</span></div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">
        <span>{% trans "بيانات المؤجر" %}</span>
      </div>
      <div class="fields">
        <div class="field"><span class="lbl">{% trans "اسم المؤجر" %}</span><span class="val">{{ lease.unit.building.owner.name|default:"" }}</span></div>
        <div class="field"><span class="lbl">Email</span><span class="val">{{ lease.unit.building.owner.email|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "رقم المؤجر" %}</span><span class="val">{{ lease.unit.building.owner.phone|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "جوال" %}</span><span class="val">{{ lease.unit.building.owner.phone|default:"" }}</span></div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">
        <span>{% trans "بيانات المستأجر" %}</span>
      </div>
      <div class="fields">
        <div class="field"><span class="lbl">{% trans "اسم المستأجر" %}</span><span class="val">{{ lease.tenant.name|default:"" }}</span></div>
        <div class="field"><span class="lbl">Email</span><span class="val">{{ lease.tenant.email|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "رقم المستأجر" %}</span><span class="val">{{ lease.tenant.phone|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "جوال" %}</span><span class="val">{{ lease.tenant.phone|default:"" }}</span></div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">
        <span>{% trans "بيانات العقار" %}</span>
      </div>
      <div class="fields">
        <div class="field"><span class="lbl">{% trans "اسم العقار" %}</span><span class="val">{{ lease.unit.building.name|default:lease.unit }}</span></div>
        <div class="field"><span class="lbl">{% trans "القطعة" %}</span><span class="val">{{ lease.unit.unit_number|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "الشارع" %}</span><span class="val">{{ lease.unit.building.address|default:"" }}</span></div>
        <div class="field"><span class="lbl">{% trans "المساحة" %}</span><span class="val">{{ lease.unit.area|default:"" }}</span></div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">
        <span>{% trans "تفاصيل العقد" %}</span>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>{% trans "نوع الدفع" %}</th>
            <th>{% trans "قيمة الإيجار" %}</th>
            <th>{% trans "من تاريخ" %}</th>
            <th>{% trans "إلى تاريخ" %}</th>
            <th>{% trans "المدة" %}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ lease.get_payment_type_display|default:"" }}</td>
            <td>{{ lease.monthly_rent|default:"" }}</td>
            <td>{{ lease.start_date|date:"d/m/Y" }}</td>
            <td>{{ lease.end_date|date:"d/m/Y" }}</td>
            <td>{{ lease.duration_display|default:"" }}</td>
          </tr>
        </tbody>
      </table>
      <div style="margin:6px;">
        <div class="muted">{% trans "ملاحظات" %}</div>
        <div class="dash"></div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">
        <span>{% trans "إقرار" %}</span>
      </div>
      <div style="padding:8px; font-size:12px; line-height:1.8;">
        {% trans "أقرّ بصحة البيانات الواردة في هذه الاستمارة والعقد المرفق، بما في ذلك قيمة الإيجار المتفق عليها، وأتحمّل كامل المسؤولية القانونية إذا ثبت عدم صحة أي بيانات. هذا التجديد يُعتبر امتداداً للعقد الأصلي." %}
      </div>
      <div class="sig-grid" style="padding: 0 8px 8px;">
        <div>
          <div class="muted">{% trans "الاسم" %}</div>
          <div class="dash"></div>
          <div class="tiny">{% trans "توقيع المستأجر" %}</div>
        </div>
        <div>
          <div class="muted">{% trans "الاسم" %}</div>
          <div class="dash"></div>
          <div class="tiny">{% trans "توقيع المؤجر" %}</div>
        </div>
        <div>
          <div class="muted">{% trans "التاريخ" %}</div>
          <div class="dash">{{ today|date:"d/m/Y" }}</div>
          <div class="tiny">{% trans "الرقم المدني" %}</div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="tiny">{% trans "هذه الاستمارة صالحة عند تجديد العقد عبر النظام" %}</div>
      <div class="badge">{{ today|date:"d/m/Y" }}</div>
    </div>
  </div>
</body>
</html>
